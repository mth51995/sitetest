<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Área de Membros</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f2f2;
}
.container {
  width: 380px;
  margin: 30px auto;
  background: #fff;
  padding: 20px;
  border-radius: 8px;
}
h2,h3 {
  text-align: center;
}
input, button {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
}
button {
  background: #0066ff;
  color: #fff;
  border: none;
  cursor: pointer;
}
button:disabled {
  background: #999;
}
.hidden {
  display: none;
}
.curso {
  background: #eee;
  padding: 10px;
  margin: 10px 0;
  cursor: pointer;
}
.aula {
  background: #ddd;
  padding: 8px;
  margin: 6px 0;
}
.ok {
  color: green;
  font-weight: bold;
}
.logout {
  background: #e74c3c;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <h2>Login</h2>
  <input id="loginEmail" type="email" placeholder="Email">
  <input id="loginSenha" type="password" placeholder="Senha">
  <button onclick="login()">Entrar</button>
  <p onclick="mostrarCadastro()" style="text-align:center;cursor:pointer">Criar conta</p>
</div>

<!-- CADASTRO -->
<div class="container hidden" id="cadastroBox">
  <h2>Cadastro</h2>
  <input id="cadNome" placeholder="Nome">
  <input id="cadEmail" type="email" placeholder="Email">
  <input id="cadSenha" type="password" placeholder="Senha">
  <button onclick="cadastrar()">Cadastrar</button>
  <p onclick="mostrarLogin()" style="text-align:center;cursor:pointer">Já tenho conta</p>
</div>

<!-- DASHBOARD -->
<div class="container hidden" id="dashboard">
  <h2 id="bemvindo"></h2>

  <h3>Meus Cursos</h3>

  <div class="curso" onclick="abrirCurso('eletricista')">
    Eletricista Predial
  </div>

  <div class="curso" onclick="abrirCurso('ar')">
    Viver de Ar Condicionado
  </div>

  <button class="logout" onclick="logout()">Sair</button>
</div>

<!-- CURSO -->
<div class="container hidden" id="cursoBox">
  <h2 id="cursoTitulo"></h2>

  <div id="listaAulas"></div>

  <p id="contador"></p>
  <button id="btnProxima" onclick="proximaAula()" disabled>
    Próxima aula
  </button>

  <button onclick="voltar()">Voltar</button>
</div>

<script>
const cursos = {
  eletricista: {
    nome: "Eletricista Predial",
    aulas: [
      "Introdução",
      "Ferramentas",
      "Instalações",
      "Quadro de energia"
    ]
  },
  ar: {
    nome: "Viver de Ar Condicionado",
    aulas: [
      "Mercado",
      "Tipos de ar",
      "Instalação",
      "Manutenção"
    ]
  }
};

let cursoAtual = "";
let aulaAtual = 0;
let timer = null;

function cadastrar() {
  let users = JSON.parse(localStorage.getItem("users")) || [];
  const nome = cadNome.value;
  const email = cadEmail.value;
  const senha = cadSenha.value;

  if (users.find(u => u.email === email)) {
    alert("Email já cadastrado");
    return;
  }

  users.push({ nome, email, senha, progresso: {} });
  localStorage.setItem("users", JSON.stringify(users));
  alert("Cadastro realizado");
  mostrarLogin();
}

function login() {
  let users = JSON.parse(localStorage.getItem("users")) || [];
  const user = users.find(u =>
    u.email === loginEmail.value &&
    u.senha === loginSenha.value
  );

  if (!user) {
    alert("Dados inválidos");
    return;
  }

  localStorage.setItem("logado", JSON.stringify(user));
  entrar(user);
}

function entrar(user) {
  loginBox.classList.add("hidden");
  cadastroBox.classList.add("hidden");
  dashboard.classList.remove("hidden");
  bemvindo.innerText = "Olá, " + user.nome;
}

function abrirCurso(id) {
  cursoAtual = id;
  aulaAtual = 0;
  dashboard.classList.add("hidden");
  cursoBox.classList.remove("hidden");
  cursoTitulo.innerText = cursos[id].nome;
  carregarAulas();
  iniciarContador();
}

function carregarAulas() {
  const user = JSON.parse(localStorage.getItem("logado"));
  listaAulas.innerHTML = "";

  cursos[cursoAtual].aulas.forEach((aula, index) => {
    const concluida = user.progresso?.[cursoAtual]?.includes(index);
    listaAulas.innerHTML += `
      <div class="aula">
        ${aula} ${concluida ? "<span class='ok'>✔</span>" : ""}
      </div>
    `;
  });
}

function iniciarContador() {
  let tempo = 10;
  btnProxima.disabled = true;
  contador.innerText = "Próxima aula em " + tempo + "s";

  timer = setInterval(() => {
    tempo--;
    contador.innerText = "Próxima aula em " + tempo + "s";

    if (tempo === 0) {
      clearInterval(timer);
      contador.innerText = "";
      btnProxima.disabled = false;
    }
  }, 1000);
}

function proximaAula() {
  let user = JSON.parse(localStorage.getItem("logado"));

  if (!user.progresso[cursoAtual]) {
    user.progresso[cursoAtual] = [];
  }

  if (!user.progresso[cursoAtual].includes(aulaAtual)) {
    user.progresso[cursoAtual].push(aulaAtual);
  }

  localStorage.setItem("logado", JSON.stringify(user));

  let users = JSON.parse(localStorage.getItem("users"));
  users = users.map(u => u.email === user.email ? user : u);
  localStorage.setItem("users", JSON.stringify(users));

  aulaAtual++;
  carregarAulas();
  iniciarContador();
}

function voltar() {
  cursoBox.classList.add("hidden");
  dashboard.classList.remove("hidden");
}

function logout() {
  localStorage.removeItem("logado");
  mostrarLogin();
}

function mostrarLogin() {
  loginBox.classList.remove("hidden");
  cadastroBox.classList.add("hidden");
  dashboard.classList.add("hidden");
  cursoBox.classList.add("hidden");
}

function mostrarCadastro() {
  loginBox.classList.add("hidden");
  cadastroBox.classList.remove("hidden");
}

const salvo = JSON.parse(localStorage.getItem("logado"));
if (salvo) entrar(salvo);
</script>

</body>
</html>
